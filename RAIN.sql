CREATE TABLE CLIMATEDATA (
    YEAR INT,
    RAINFALL DECIMAL,
    RELATIVE_HUMIDITY DECIMAL,
    TEMPERATURE DECIMAL
);
-- inserting data
INSERT INTO CLIMATEDATA (YEAR, RAINFALL, RELATIVE_HUMIDITY, TEMPERATURE)
VALUES
    (2015, 129.2051282, 66.00333333, 22.62666667),
    (2016, 119.2435897, 66.72666667, 23.16666667),
    (2017, 68.98717949, 64.37666667, 23.25),
    (2018, 271.3333333, 81.98, 19.42),
    (2019, 70.19230769, 60.39666667, 24.12666667),
    (2020, 190.4358974, 77.74666667, 21.00333333),
    (2021, 118.6025641, 67.64666667, 22.39),
    (2022, 72.74358974, 61.39666667, 23.61333333),
    (2023, 106.5128205, 68.28416667, 22.44958333),
    (2024, 292.6794872, 68.28416667, 22.44958333);

-- Average Climate Trends:
SELECT YEAR, AVG(RAINFALL) AS AVG_RAINFALL, AVG(RELATIVE_HUMIDITY) AS AVG_HUMIDITY, AVG(TEMPERATURE) AS AVG_TEMPERATURE
FROM CLIMATEDATA
GROUP BY YEAR
ORDER BY YEAR;

-- Correlation between Climate Variables:
SELECT
    (SUM(RAINFALL * RELATIVE_HUMIDITY) - SUM(RAINFALL) * SUM(RELATIVE_HUMIDITY) / COUNT(*)) /
    (SQRT((SUM(RAINFALL * RAINFALL) - SUM(RAINFALL) * SUM(RAINFALL) / COUNT(*)) *
          (SUM(RELATIVE_HUMIDITY * RELATIVE_HUMIDITY) - SUM(RELATIVE_HUMIDITY) * SUM(RELATIVE_HUMIDITY) / COUNT(*))))
    AS RAINFALL_HUMIDITY_CORRELATION,
    (SUM(RAINFALL * TEMPERATURE) - SUM(RAINFALL) * SUM(TEMPERATURE) / COUNT(*)) /
    (SQRT((SUM(RAINFALL * RAINFALL) - SUM(RAINFALL) * SUM(RAINFALL) / COUNT(*)) *
          (SUM(TEMPERATURE * TEMPERATURE) - SUM(TEMPERATURE) * SUM(TEMPERATURE) / COUNT(*))))
    AS RAINFALL_TEMPERATURE_CORRELATION,
    (SUM(RELATIVE_HUMIDITY * TEMPERATURE) - SUM(RELATIVE_HUMIDITY) * SUM(TEMPERATURE) / COUNT(*)) /
    (SQRT((SUM(RELATIVE_HUMIDITY * RELATIVE_HUMIDITY) - SUM(RELATIVE_HUMIDITY) * SUM(RELATIVE_HUMIDITY) / COUNT(*)) *
          (SUM(TEMPERATURE * TEMPERATURE) - SUM(TEMPERATURE) * SUM(TEMPERATURE) / COUNT(*))))
    AS HUMIDITY_TEMPERATURE_CORRELATION
FROM CLIMATEDATA;

-- Identifying Extreme Weather Years:
SELECT YEAR, RAINFALL, RELATIVE_HUMIDITY, TEMPERATURE
FROM CLIMATEDATA
WHERE RAINFALL > (SELECT AVG(RAINFALL) + 2 * STDDEV_SAMP(RAINFALL) FROM CLIMATEDATA)
   OR RELATIVE_HUMIDITY < (SELECT AVG(RELATIVE_HUMIDITY) - 2 * STDDEV_SAMP(RELATIVE_HUMIDITY) FROM CLIMATEDATA)
   OR TEMPERATURE > (SELECT AVG(TEMPERATURE) + 2 * STDDEV_SAMP(TEMPERATURE) FROM CLIMATEDATA)
ORDER BY YEAR;



